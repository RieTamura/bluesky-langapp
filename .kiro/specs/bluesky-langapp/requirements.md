# ---
# 今後の開発方針・段階的実装計画（設計書より抜粋）

## Next.js + Expo 構成案と移行戦略

- Web版はNext.js（Reactベース）、モバイルはExpo（React Native/React Native for Web）で開発。
- UI部品・ロジックは`shared/`ディレクトリでWeb/モバイル共通化。
- バックエンドAPIはExpress.js（現状維持）。

### ディレクトリ構成例

```
bluesky-langapp/
├── backend/         # Express.js API
├── web/             # Next.js Webアプリ
├── mobile/          # Expo（React Native）アプリ
└── shared/          # 共通ロジック・型・APIクライアント
```

### 技術スタック
- Web：Next.js＋React＋Tailwind CSS
- Mobile：Expo＋React Native＋React Native for Web
- 共通：TypeScript、Zustand/Recoil（状態管理）、Axios（API通信）

### UI部品・ロジックの共通化
- `shared/components/`や`shared/hooks/`にWeb/Expo両対応のReactコンポーネント・ロジックを配置
- Next.jsとExpoでimportして利用

### API連携
- Express.js APIはWeb/モバイル両方からfetch/axiosで利用
- 認証・投稿取得・単語管理・学習進捗などのAPIは共通

### 段階的移行手順
1. Astro→Next.jsへのWeb移行
2. UI部品の共通化
3. Expo（React Native）アプリ新規開発
4. APIクライアントの共通化
5. 段階的リリース（Web→Expo→API拡張）

### タスクリスト（フェーズ別抜粋）

#### フェーズ1: 基本機能
- Bluesky認証・セッション管理
- 投稿取得・単語抽出・色分け表示
- 単語保存・ステータス管理

#### フェーズ2: 学習・進捗機能
- クイズ機能・進捗更新
- 統計グラフ・履歴表示
- 目標設定・進捗バー

#### フェーズ3: 高度な機能・UI改善
- データエクスポート・バックアップ
- モバイル対応・レスポンシブUI
- Expo/Next.jsによるクロスプラットフォーム化
# 要件定義書

## はじめに

Bluesky LangAppは、Blueskyソーシャルネットワークの投稿を活用した言語学習アプリケーションです。ユーザーは自分のBluesky投稿から未知の単語を発見し、語彙力向上を図ることができます。現在のCLIベースのプロトタイプをWebアプリケーションとして発展させ、より使いやすく機能豊富な学習プラットフォームを構築します。

## 要件

### 要件1：ユーザー認証とBluesky連携

**ユーザーストーリー:** ユーザーとして、自分のBlueskyアカウントでログインして、投稿データにアクセスしたい。

#### 受け入れ基準

1. WHEN ユーザーがログインページにアクセスする THEN システムはBlueskyの認証情報入力フォームを表示する
2. WHEN ユーザーが有効なBluesky IDとApp Passwordを入力する THEN システムはBluesky APIに認証を行い、成功時にダッシュボードにリダイレクトする
3. IF 認証に失敗した場合 THEN システムは適切なエラーメッセージを表示し、再入力を促す
4. WHEN ユーザーがログインしている THEN システムはセッションを維持し、ページリロード時も認証状態を保持する

### 要件2：投稿データの取得と表示

**ユーザーストーリー:** ユーザーとして、自分のBluesky投稿を閲覧し、学習対象の単語を特定したい。

#### 受け入れ基準

1. WHEN ユーザーがダッシュボードにアクセスする THEN システムは最新の投稿を取得して表示する
2. WHEN システムが投稿を表示する THEN 各単語は学習状況に応じて色分けされる（既知：緑、未知：赤、学習中：黄）
3. WHEN ユーザーが投稿の取得件数を指定する THEN システムは指定された件数の投稿を取得する
4. IF 投稿の取得に失敗した場合 THEN システムは適切なエラーメッセージを表示する

### 要件3：単語管理機能

**ユーザーストーリー:** ユーザーとして、未知の単語を保存し、学習状況を管理したい。

#### 受け入れ基準

1. WHEN ユーザーが未知の単語をクリックする THEN システムは単語の詳細情報と保存オプションを表示する
2. WHEN ユーザーが単語を保存する THEN システムは単語を学習リストに追加し、ステータスを「学習中」に設定する
3. WHEN ユーザーが単語のステータスを変更する THEN システムは新しいステータス（未知、学習中、既知）を保存する
4. WHEN ユーザーが学習リストにアクセスする THEN システムは保存された全ての単語とその学習状況を表示する
5. WHEN ユーザーが単語リストを表示する THEN システムは追加日順（新しい順）で単語を並び替えて表示する
6. WHEN ユーザーが並び替えオプションを選択する THEN システムは選択された順序で単語リストを再表示する
7. WHEN ユーザーが単語を削除する THEN システムは確認ダイアログを表示し、確認後に単語を学習リストから削除する

### 要件4：単語学習機能

**ユーザーストーリー:** ユーザーとして、保存した単語の意味を調べ、効果的に学習したい。

#### 受け入れ基準

1. WHEN ユーザーが単語の詳細を表示する THEN システムは単語の意味、例文、発音情報を提供する
2. WHEN ユーザーがクイズモードを開始する THEN システムは学習中の単語からランダムに問題を出題する
3. WHEN ユーザーがクイズに回答する THEN システムは正解・不正解を判定し、学習進捗を更新する
4. IF ユーザーが単語を連続して正解した場合 THEN システムは自動的にステータスを「既知」に更新する

### 要件5：学習進捗の可視化

**ユーザーストーリー:** ユーザーとして、自分の学習進捗を視覚的に確認し、モチベーションを維持したい。

#### 受け入れ基準

1. WHEN ユーザーが進捗ページにアクセスする THEN システムは学習統計をグラフで表示する
2. WHEN システムが統計を表示する THEN 総単語数、既知単語数、学習中単語数、学習日数を含む
3. WHEN ユーザーが日別の学習履歴を確認する THEN システムは過去30日間の学習活動をカレンダー形式で表示する
4. WHEN ユーザーが目標を設定する THEN システムは目標達成度を進捗バーで表示する

### 要件6：データの永続化とバックアップ

**ユーザーストーリー:** ユーザーとして、学習データが安全に保存され、デバイス間で同期されることを期待する。

#### 受け入れ基準

1. WHEN ユーザーが単語を保存・更新する THEN システムはデータをデータベースに永続化する
2. WHEN システムがデータを保存する THEN 各操作にタイムスタンプを記録する
3. WHEN ユーザーがデータのエクスポートを要求する THEN システムはJSON形式でデータをダウンロード可能にする
4. IF データベースエラーが発生した場合 THEN システムは適切なエラーハンドリングを行い、データ損失を防ぐ

### 要件7：レスポンシブWebインターフェース

**ユーザーストーリー:** ユーザーとして、デスクトップとモバイルデバイスの両方で快適にアプリを使用したい。

#### 受け入れ基準

1. WHEN ユーザーがモバイルデバイスでアクセスする THEN システムはモバイル最適化されたレイアウトを表示する
2. WHEN ユーザーがタッチデバイスを使用する THEN システムはタッチフレンドリーなインターフェースを提供する
3. WHEN 画面サイズが変更される THEN システムは自動的にレイアウトを調整する
4. WHEN ユーザーがキーボードショートカットを使用する THEN システムは主要な操作をキーボードで実行可能にする